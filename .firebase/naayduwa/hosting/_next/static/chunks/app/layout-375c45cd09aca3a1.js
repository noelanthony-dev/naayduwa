(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2446:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,3673,23)),Promise.resolve().then(a.bind(a,5174)),Promise.resolve().then(a.bind(a,4046))},3673:()=>{},4046:(e,t,a)=>{"use strict";a.d(t,{CalendarProvider:()=>I,_:()=>w});var n=a(2115),r=a(2553),l=a(4585),o=a(9708);let d=(0,o.aU)(l.y),s="events";async function i(e){var t;let a=(0,o.H9)((0,o.rJ)(d,s),e.id),n=null==(t=(0,r.xI)(l.y).currentUser)?void 0:t.uid,i=E({...e,...n?{ownerUid:n}:{},updatedAt:o.Dc.fromMillis(Date.now())});await (0,o.BN)(a,i,{merge:!0})}async function c(e){await (0,o.kd)((0,o.H9)(d,s,e))}async function u(e,t){var a;let n=(0,o.H9)(d,s,e),r=await (0,o.x7)(n);if(!r.exists())return;let l=[...null!=(a=r.data().attendees)?a:[],t];await (0,o.mZ)(n,E({attendees:l,updatedAt:o.Dc.fromMillis(Date.now())}))}async function f(e,t){var a;let n=(0,o.H9)(d,s,e),r=await (0,o.x7)(n);if(!r.exists())return;let l=(null!=(a=r.data().attendees)?a:[]).filter(e=>e.id!==t);await (0,o.mZ)(n,E({attendees:l,updatedAt:o.Dc.fromMillis(Date.now())}))}function E(e){let t=e=>{if(Array.isArray(e))return e.map(t);if(null!==e&&"object"==typeof e){let a={};for(let[n,r]of Object.entries(e)){let e=t(r);void 0!==e&&(a[n]=e)}return a}return void 0===e?void 0:e};return t(e)}let p="naayduwa:calendar";function y(e){localStorage.setItem(p,JSON.stringify(e))}function v(e){return e.toISOString().slice(0,10)}function m(e){return v(new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1)))}function D(e){return e instanceof Error?e.message:String(e)}let T=null;function S(e){T&&(T({type:"SHOW_TOAST",payload:e}),setTimeout(()=>T&&T({type:"CLEAR_TOAST"}),3e3))}let A=v(new Date),O=function(e){let t=localStorage.getItem(p);return t?JSON.parse(t):e}({monthCursorISO:m(new Date),selectedDateISO:A,events:[],modal:{addEventOpen:!1},toastMessage:null});function _(e,t){switch(t.type){case"INIT_EVENTS":{let a={...e,events:t.payload};return y(a),a}case"NAV_MONTH":{let a=new Date(e.monthCursorISO+"T00:00:00Z");a.setUTCMonth(a.getUTCMonth()+t.payload);let n=m(a),r={...e,monthCursorISO:n};return y(r),r}case"SET_SELECTED_DATE":{let a={...e,selectedDateISO:t.payload};return y(a),a}case"OPEN_ADD_EVENT":{let a={...e,modal:{...e.modal,addEventOpen:!0},selectedDateISO:t.payload};return y(a),a}case"CLOSE_ADD_EVENT":{let t={...e,modal:{...e.modal,addEventOpen:!1}};return y(t),t}case"ADD_EVENT":{i(t.payload).catch(e=>{console.error("Add event failed:",e),S("Add failed: ".concat(D(e)))});let a={...e,modal:{...e.modal,addEventOpen:!1}};return y(a),a}case"OPEN_DETAILS":{let a={...e,modal:{...e.modal,detailsEventId:t.payload}};return y(a),a}case"CLOSE_DETAILS":{let t={...e,modal:{...e.modal,detailsEventId:void 0}};return y(t),t}case"ADD_ATTENDEE":return u(t.payload.eventId,t.payload.attendee).catch(e=>{console.error("Add attendee failed:",e),S("Add attendee failed: ".concat(D(e)))}),e;case"REMOVE_ATTENDEE":return f(t.payload.eventId,t.payload.attendeeId).catch(e=>{console.error("Remove attendee failed:",e),S("Remove attendee failed: ".concat(D(e)))}),e;case"DELETE_EVENT":{c(t.payload.eventId).catch(e=>{console.error("Delete event failed:",e),S("Delete failed: ".concat(D(e)))});let a={...e,modal:{...e.modal,detailsEventId:void 0}};return y(a),a}case"UPDATE_EVENT":{i(t.payload.event).catch(e=>{console.error("Update event failed:",e),S("Update failed: ".concat(D(e)))});let a=e.events.map(e=>e.id===t.payload.event.id?t.payload.event:e),n={...e,events:a};return y(n),n}case"SHOW_TOAST":{let a={...e,toastMessage:t.payload};return y(a),a}case"CLEAR_TOAST":{let t={...e,toastMessage:null};return y(t),t}default:return e}}let h=(0,n.createContext)(null);function I(e){let{children:t}=e,[a,r]=(0,n.useReducer)(_,O);T=r,n.useEffect(()=>{let e=function(e){let t=(0,o.P)((0,o.rJ)(d,s),(0,o.My)("dateISO"),(0,o.My)("startTime"));return(0,o.aQ)(t,t=>{let a=[];t.forEach(e=>{var t;let n,r=e.data(),l=r.updatedAt;n="number"==typeof l?l:l&&"function"==typeof l.toMillis?l.toMillis():Date.now(),a.push({...r,attendees:null!=(t=r.attendees)?t:[],id:e.id,updatedAt:n})}),e(a)})}(e=>{r({type:"INIT_EVENTS",payload:e})});return()=>e()},[]);let l=(0,n.useMemo)(()=>({state:a,dispatch:r}),[a]);return n.createElement(h.Provider,{value:l},t)}function w(){let e=(0,n.useContext)(h);if(!e)throw Error("useCalendar must be used within CalendarProvider");return e}},4585:(e,t,a)=>{"use strict";a.d(t,{j:()=>o,y:()=>l});var n=a(2078),r=a(2553);let l=(0,n.Dk)().length?(0,n.Dk)()[0]:(0,n.Wp)({apiKey:"AIzaSyD7_XOXmHNRH8vVtRQdODbsS5cEG2kYN_U",authDomain:"naayduwa.firebaseapp.com",projectId:"naayduwa",storageBucket:"naayduwa.firebasestorage.app",messagingSenderId:"641198466977",appId:"1:641198466977:web:4689ca314da4076f558de0"}),o=(0,r.xI)(l);(0,r.zK)(o).catch(e=>{console.error("Anonymous sign-in failed",e)})},5174:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>s});var n=a(5155),r=a(2115),l=a(4585),o=a(2553);let d=(0,r.createContext)({user:null,loading:!0});function s(e){let{children:t}=e,[a,s]=(0,r.useState)(null),[i,c]=(0,r.useState)(!0),[u,f]=(0,r.useState)();return(0,r.useEffect)(()=>(0,o.hg)(l.j,async e=>{try{e?s(e):await (0,o.zK)(l.j)}catch(t){let e=t instanceof Error?t:Error(String(t));f(e),console.error("Anonymous sign-in failed",e)}finally{c(!1)}}),[]),(0,n.jsx)(d.Provider,{value:{user:a,loading:i,error:u},children:t})}}},e=>{e.O(0,[978,135,965,240,441,255,358],()=>e(e.s=2446)),_N_E=e.O()}]);